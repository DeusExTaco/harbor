---
# bandit.yaml
# Harbor Container Updater - Bandit Security Configuration
# Security scanning configuration for Harbor project

# Test exclusions - Only exclude tests that are genuinely false positives
skips:
  # B101: Assert statements used in tests and development
- B101

  # B104: Binding to 0.0.0.0 is required for Docker containers
- B104

  # B110: Try/except/pass used for optional dependency detection
- B110

# File and directory exclusions
exclude_dirs:
- tests
- scripts/dev
- build
- dist
- .eggs
- venv
- .venv
- env
- __pycache__
- .pytest_cache
- .mypy_cache
- .ruff_cache
- .git
- node_modules
- docs/_build
- examples
- deploy/examples

# Exclude specific file patterns
exclude:
- '*_test.py'
- test_*.py
- tests/**/*
- debug_*.py
- simple_*.py
- validate_*.py
- check_*.py
- deep_debug_*.py
- migrations/versions/*.py
- app/db/migrations/versions/*.py

# Test configuration
tests:
- B102   # exec_used
- B103   # set_bad_file_permissions
- B105   # hardcoded_password_string
- B106   # hardcoded_password_funcarg
- B107   # hardcoded_password_default
- B108   # hardcoded_tmp_directory
- B201   # flask_debug_true
- B301   # pickle
- B302   # marshal
- B303   # md5
- B304   # des
- B305   # cipher
- B306   # mktemp_q
- B307   # eval
- B311   # random
- B321   # ftplib
- B324   # hashlib_new_insecure_functions
- B401   # import_telnetlib
- B402   # import_ftplib
- B403   # import_pickle
- B404   # import_subprocess
- B501   # request_with_no_cert_validation
- B502   # ssl_with_bad_version
- B503   # ssl_with_bad_defaults
- B504   # ssl_with_no_version
- B505   # weak_cryptographic_key
- B506   # yaml_load
- B507   # ssh_no_host_key_verification
- B601   # paramiko_calls
- B602   # subprocess_popen_with_shell_equals_true
- B603   # subprocess_without_shell_equals_false
- B604   # any_other_function_with_shell_equals_true
- B605   # start_process_with_a_shell
- B606   # start_process_with_no_shell
- B607   # start_process_with_partial_path
- B609   # linux_commands_wildcard_injection
- B610   # django_extra_used
- B611   # django_rawsql_used
- B701   # jinja2_autoescape_false
- B702   # use_of_mako_templates
- B703   # django_mark_safe

# Severity and confidence levels
confidence: MEDIUM
severity: LOW # Include LOW to see subprocess warnings during development

# Output format
format: txt
include_nosec: false
report_skipped: false
verbose: false

# Custom test configurations for specific files
# These allow us to handle known safe patterns
per_file_ignores:
  # app/config.py uses subprocess safely for Docker detection
  app/config.py:
  - B404   # subprocess import - needed for Docker detection
  - B603   # subprocess usage - controlled command, no user input
  - B607   # partial path - docker is a well-known command
  - B108   # temp directory - will be fixed with tempfile module

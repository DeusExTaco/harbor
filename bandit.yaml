# Harbor Container Updater - Bandit Security Configuration
# Configuration file: bandit.yaml (place in project root)
# Addresses Harbor-specific security scan exclusions

# =============================================================================
# Test Exclusions - Skip specific security tests
# =============================================================================
skips:
  # B101: Assert statements are expected in test files
  - B101

  # B104: Binding to all interfaces is safe in Docker containers
  - B104

  # B110: Try/except/pass is acceptable for environment detection
  - B110

  # B608: Hardcoded SQL expressions (false positive in config templates)
  - B608

# =============================================================================
# File and Directory Exclusions
# =============================================================================
exclude_dirs:
  # Test directories
  - tests
  - test

  # Build and distribution directories
  - build
  - dist
  - .eggs
  - "*.egg-info"

  # Virtual environments
  - venv
  - .venv
  - env

  # Cache directories
  - __pycache__
  - .pytest_cache
  - .mypy_cache
  - .ruff_cache

  # Version control
  - .git

  # Documentation build
  - site
  - docs/_build

# Exclude specific file patterns
exclude:
  # Test files (comprehensive patterns)
  - "*_test.py"
  - "test_*.py"
  - "tests/**/*"

  # Development and debugging scripts
  - "debug_*.py"
  - "simple_*.py"
  - "validate_*.py"
  - "scripts/**/*"

  # Migration files (SQLAlchemy/Alembic)
  - "migrations/versions/*.py"
  - "alembic/versions/*.py"

  # Configuration examples and templates
  - "examples/**/*"
  - "templates/**/*"

# =============================================================================
# Security Test Configuration
# =============================================================================

# Only run tests that are relevant for Harbor
tests:
  - B102 # exec_used
  - B103 # set_bad_file_permissions
  - B105 # hardcoded_password_string
  - B106 # hardcoded_password_funcarg
  - B107 # hardcoded_password_default
  - B108 # hardcoded_tmp_directory
  - B112 # try_except_continue
  - B201 # flask_debug_true
  - B301 # pickle
  - B302 # marshal
  - B303 # md5
  - B304 # des
  - B305 # cipher
  - B306 # mktemp_q
  - B307 # eval
  - B308 # mark_safe
  - B309 # httpsconnection
  - B310 # urllib_urlopen
  - B311 # random
  - B312 # telnetlib
  - B313 # xml_bad_cElementTree
  - B314 # xml_bad_ElementTree
  - B315 # xml_bad_expatreader
  - B316 # xml_bad_expatbuilder
  - B317 # xml_bad_sax
  - B318 # xml_bad_minidom
  - B319 # xml_bad_pulldom
  - B320 # xml_bad_xmlparser
  - B321 # ftplib
  - B322 # input
  - B323 # unverified_context
  - B324 # hashlib_new_insecure_functions
  - B325 # tempnam
  - B401 # import_telnetlib
  - B402 # import_ftplib
  - B403 # import_pickle
  - B404 # import_subprocess
  - B405 # import_xml_etree
  - B406 # import_xml_sax
  - B407 # import_xml_expat
  - B408 # import_xml_minidom
  - B409 # import_xml_pulldom
  - B410 # import_lxml
  - B411 # import_xmlrpclib
  - B412 # import_httpoxy
  - B413 # import_pycrypto
  - B501 # request_with_no_cert_validation
  - B502 # ssl_with_bad_version
  - B503 # ssl_with_bad_defaults
  - B504 # ssl_with_no_version
  - B505 # weak_cryptographic_key
  - B506 # yaml_load
  - B507 # ssh_no_host_key_verification
  - B601 # paramiko_calls
  - B602 # subprocess_popen_with_shell_equals_true
  - B603 # subprocess_without_shell_equals_false
  - B604 # any_other_function_with_shell_equals_true
  - B605 # start_process_with_a_shell
  - B606 # start_process_with_no_shell
  - B607 # start_process_with_partial_path
  - B609 # linux_commands_wildcard_injection
  - B610 # django_extra_used
  - B611 # django_rawsql_used
  - B701 # jinja2_autoescape_false
  - B702 # use_of_mako_templates
  - B703 # django_mark_safe

# =============================================================================
# Reporting Configuration
# =============================================================================

# Set confidence and severity levels
confidence: MEDIUM # LOW, MEDIUM, HIGH
severity: MEDIUM # LOW, MEDIUM, HIGH

# Output format
format: txt # txt, json, csv, xml

# Additional options
include_nosec: false # Don't include # nosec comments in output
report_skipped: false # Don't report skipped tests to reduce noise

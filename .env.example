# Harbor Container Updater - Environment Variables Template
# Copy this file to .env and customize for your deployment
# Following Harbor project structure from foundational documents

# =============================================================================
# CORE CONFIGURATION
# =============================================================================
HARBOR_MODE=homelab                    # homelab, development, staging, production
HARBOR_DEBUG=false                     # Enable debug mode
HARBOR_HOST=0.0.0.0                   # Server bind address
HARBOR_PORT=8080                      # Server port

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
# Generate with: openssl rand -base64 32
# HARBOR_SECURITY_SECRET_KEY=your-generated-secret-key-here

HARBOR_SECURITY_REQUIRE_HTTPS=false          # Require HTTPS (set true for production)
HARBOR_SECURITY_SESSION_TIMEOUT_HOURS=168    # Session timeout (1 week for homelab)
HARBOR_SECURITY_API_KEY_REQUIRED=false       # Require API key for access
HARBOR_SECURITY_PASSWORD_MIN_LENGTH=6        # Minimum password length
HARBOR_SECURITY_PASSWORD_REQUIRE_SPECIAL=false # Require special characters

# Alternative: Load secret from file
# HARBOR_SECURITY_SECRET_KEY_FILE=/run/secrets/harbor_secret

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# SQLite (default for home lab)
HARBOR_DB_DATABASE_URL=sqlite:///data/harbor.db

# PostgreSQL (for production)
# HARBOR_DB_DATABASE_URL=postgresql://harbor:password@localhost:5432/harbor

HARBOR_DB_POOL_SIZE=5                 # Connection pool size
HARBOR_DB_MAX_OVERFLOW=2              # Pool overflow connections
HARBOR_DB_POOL_TIMEOUT=30             # Connection timeout (seconds)
HARBOR_DB_ECHO_SQL=false              # Echo SQL queries (development only)

# Backup settings (home lab)
HARBOR_DB_BACKUP_ENABLED=true         # Enable automatic backups
HARBOR_DB_BACKUP_RETENTION_DAYS=7     # Days to retain backups

# =============================================================================
# DOCKER CONFIGURATION
# =============================================================================
HARBOR_DOCKER_DOCKER_HOST=unix:///var/run/docker.sock  # Docker socket
# HARBOR_DOCKER_DOCKER_HOST=tcp://docker-socket-proxy:2375  # For socket proxy

HARBOR_DOCKER_DOCKER_TIMEOUT=60                        # Docker API timeout
HARBOR_DOCKER_DISCOVERY_INTERVAL_SECONDS=300           # Discovery interval (5 min)
HARBOR_DOCKER_INCLUDE_STOPPED_CONTAINERS=true          # Include stopped containers

# =============================================================================
# UPDATE CONFIGURATION
# =============================================================================
HARBOR_UPDATE_DEFAULT_CHECK_INTERVAL_SECONDS=86400     # Daily checks
HARBOR_UPDATE_DEFAULT_UPDATE_TIME=03:00                # 3 AM updates
HARBOR_UPDATE_DEFAULT_TIMEZONE=UTC                     # Update timezone
HARBOR_UPDATE_MAX_CONCURRENT_UPDATES=2                 # Conservative for home lab
HARBOR_UPDATE_UPDATE_DELAY_SECONDS=0                   # Delay between updates

# Safety settings
HARBOR_UPDATE_DEFAULT_HEALTH_CHECK_TIMEOUT=60          # Health check timeout
HARBOR_UPDATE_DEFAULT_ROLLBACK_ENABLED=true            # Enable rollback
HARBOR_UPDATE_DEFAULT_CLEANUP_ENABLED=true             # Enable cleanup
HARBOR_UPDATE_DEFAULT_CLEANUP_KEEP_IMAGES=2            # Keep N old images
HARBOR_UPDATE_CLEANUP_DELAY_HOURS=24                   # Cleanup delay

# =============================================================================
# REGISTRY CONFIGURATION
# =============================================================================
HARBOR_REGISTRY_TIMEOUT_SECONDS=30                     # Registry timeout
HARBOR_REGISTRY_RETRY_COUNT=3                          # Retry attempts
HARBOR_REGISTRY_CACHE_TTL_SECONDS=3600                 # Cache TTL (1 hour)
HARBOR_REGISTRY_CACHE_SIZE_MB=50                       # Cache size limit
HARBOR_REGISTRY_RATE_LIMIT_CALLS_PER_HOUR=100          # API call limit

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
HARBOR_LOG_LOG_LEVEL=INFO                              # TRACE, DEBUG, INFO, WARN, ERROR, CRITICAL
HARBOR_LOG_LOG_FORMAT=text                             # text (homelab), json (production)
HARBOR_LOG_LOG_TO_FILE=true                            # Enable file logging
HARBOR_LOG_LOG_TO_CONSOLE=true                         # Enable console logging
HARBOR_LOG_LOG_ROTATION_SIZE_MB=10                     # Log rotation size
HARBOR_LOG_LOG_RETENTION_DAYS=14                       # Log retention period

# Custom log file path (optional)
# HARBOR_LOG_LOG_FILE_PATH=/app/logs/custom.log

# =============================================================================
# RESOURCE CONFIGURATION
# =============================================================================
HARBOR_RESOURCE_MAX_MEMORY_USAGE_MB=512                # Memory limit
HARBOR_RESOURCE_MAX_DISK_USAGE_GB=10                   # Disk usage limit
HARBOR_RESOURCE_MAX_WORKERS=auto                       # Worker processes (auto or number)

# =============================================================================
# FEATURE FLAGS
# =============================================================================
# v1.0 Features (M0-M6) - Always enabled
HARBOR_FEATURE_ENABLE_AUTO_DISCOVERY=true              # Container auto-discovery
HARBOR_FEATURE_ENABLE_METRICS=true                     # Prometheus metrics
HARBOR_FEATURE_ENABLE_HEALTH_CHECKS=true               # Health monitoring

# Home lab specific features
HARBOR_FEATURE_SHOW_GETTING_STARTED=true               # Setup wizard
HARBOR_FEATURE_ENABLE_SIMPLE_MODE=true                 # Simplified UI
HARBOR_FEATURE_AUTO_EXCLUDE_HARBOR=true                # Exclude Harbor from updates

# Future features (v1.1+) - Behind feature flags (disabled by default)
# TODO: M7+ - Advanced authentication
HARBOR_FEATURE_ENABLE_MFA=false                        # Multi-factor auth (M7+)
HARBOR_FEATURE_ENABLE_MULTI_USER=false                 # Multiple users (M8+)
HARBOR_FEATURE_ENABLE_RBAC=false                       # Role-based access (M8+)

# TODO: M8+ - Advanced update strategies
HARBOR_FEATURE_ENABLE_BLUE_GREEN=false                 # Blue/green deployments (M8+)
HARBOR_FEATURE_ENABLE_CANARY=false                     # Canary deployments (M8+)

# TODO: M9+ - Enterprise integrations
HARBOR_FEATURE_ENABLE_LDAP=false                       # LDAP authentication (M9+)
HARBOR_FEATURE_ENABLE_KUBERNETES=false                 # Kubernetes runtime (M9+)

# =============================================================================
# DEVELOPMENT SPECIFIC
# =============================================================================
# Only used in development profile
HARBOR_DEV_RELOAD=true                                 # Auto-reload on changes
HARBOR_DEV_PROFILING=false                             # Enable profiling

# =============================================================================
# PRODUCTION SPECIFIC
# =============================================================================
# Only used in production profile
HARBOR_PROD_WORKERS=auto                               # Gunicorn workers
HARBOR_PROD_PRELOAD=true                               # Preload application

# =============================================================================
# OPTIONAL INTEGRATIONS
# =============================================================================
# Redis (for production caching and sessions)
# REDIS_URL=redis://localhost:6379/0

# External monitoring
# PROMETHEUS_MULTIPROC_DIR=/tmp/prometheus_multiproc

# Notification services (future)
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/...
# EMAIL_SMTP_HOST=smtp.gmail.com
# EMAIL_SMTP_PORT=587

# =============================================================================
# PROFILE-SPECIFIC EXAMPLES
# =============================================================================

# Home Lab Profile (default)
# HARBOR_MODE=homelab
# HARBOR_SECURITY_REQUIRE_HTTPS=false
# HARBOR_UPDATE_MAX_CONCURRENT_UPDATES=2
# HARBOR_LOG_LOG_LEVEL=INFO
# HARBOR_LOG_LOG_FORMAT=text

# Development Profile
# HARBOR_MODE=development
# HARBOR_DEBUG=true
# HARBOR_LOG_LOG_LEVEL=DEBUG
# HARBOR_DB_ECHO_SQL=true

# Production Profile
# HARBOR_MODE=production
# HARBOR_SECURITY_REQUIRE_HTTPS=true
# HARBOR_SECURITY_API_KEY_REQUIRED=true
# HARBOR_SECURITY_PASSWORD_MIN_LENGTH=12
# HARBOR_UPDATE_MAX_CONCURRENT_UPDATES=10
# HARBOR_LOG_LOG_FORMAT=json
# HARBOR_DB_DATABASE_URL=postgresql://user:pass@host:5432/harbor

# =============================================================================
# QUICK SETUP COMMANDS
# =============================================================================
# Generate secret key:
#   openssl rand -base64 32
#
# Create .env file:
#   cp .env.example .env
#   # Edit .env with your settings
#
# Validate configuration:
#   python -m app.config
#
# Export template for profile:
#   python -c "from app.config import export_config_template, DeploymentProfile; print(export_config_template(DeploymentProfile.PRODUCTION))"
